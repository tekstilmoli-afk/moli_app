@login_required
def depo_detay(request, depo_adi):
    stoklar = (
        DepoStok.objects
        .filter(depo=depo_adi)
        .select_related("order")
        .order_by("-eklenme_tarihi")
    )

    toplam_adet = stoklar.aggregate(Sum("adet"))["adet__sum"] or 0
    siparisler = Order.objects.all().order_by("-siparis_tarihi")

    context = {
        "depo_adi": depo_adi,
        "stoklar": stoklar,
        "toplam_adet": toplam_adet,
        "siparisler": siparisler,
    }

    # ðŸš« TarayÄ±cÄ± ve ara proxy Ã¶nbelleÄŸini kapat
    response = render(request, "depolar/detay.html", context)
    response["Cache-Control"] = "no-cache, no-store, must-revalidate"
    response["Pragma"] = "no-cache"
    response["Expires"] = "0"
    return response
